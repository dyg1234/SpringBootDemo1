<!doctype html>
<html style="height:100%">
<head>
<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta name="format-detection" content="telephone=no;email=no">
<meta name="applicable-device" content="pc,mobile">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="renderer" content="webkit"/>
<meta name="force-rendering" content="webkit"/>
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
<title>无标题文档</title>
<link rel="stylesheet" type="text/css" href="images/19ixm_style.css">
<link rel="stylesheet" type="text/css" href="images/19ixm_media_style.css">

    <link rel="stylesheet" type="text/css" href="js/sliding-verify.css">

<script type="text/javascript" src="images/jquery.min.js"></script>
<script type="text/javascript" src="images/jquery.SuperSlide.js"></script>
<script type="text/javascript" src="images/TouchSlide.source.js"></script>
</head>

<body id="page1" style="background-image:url(images/19ixm_dl_bg1.jpg)">
<div class="dl_head">
    <div class="contain">
        <div class="head">
            <div class="logo"><img src="images/19ixm_logo.png"></div>
            <div class="dl_tit tgray1"><a href="#">关于我们</a> ｜ <a href="#">使用帮助</a> ｜ <a href="#">人工申诉</a> ｜ <a href="#">联系我们</a> ｜ <a href="#">法律声明</a><a href="#" class="mar_l20"><img src="images/19ixm_dl_btn.png"></a></div>
            <div class="clear"></div>
        </div>
    </div>
</div>
<div class="dl_con">
	<div class="contain">

        <div class="zhdl_con"><i class="zhdl_tu"></i><em class="ewm_t1"></em>
            <div class="dlts_xx" style="display:none">用户名或密码错误!</div>
            <div class="zhdl_tit">

                <ul>
                    <li class="on">市民帐号</li>
                    <li>法人帐号</li>
                </ul>
                <div class="clear"></div>
            </div>
            <div> <input type="hidden" name="loginType" value="0"> 
                <div class="form_tit"><span class="dl_icon1"></span><input name="" type="text" placeholder="请输入用户名/手机/身份证号/邮箱"></div>
                <!--<div class="mar_t20">
                    <div class="form_tit2"><span class="dl_icon3"></span><input name="" type="text" placeholder="请输入右侧验证码" class="inp2"></div>
                    <div class="form_r"><img src="images/19ixm_dl_tu.png"></div>
                    <div class="clear"></div>
                </div>-->
                <div class="mar_t20" id="passDiv">
                    <div class="form_tit"><span class="dl_icon2"></span><input name="" type="text" placeholder="请输入密码"></div>

                    <!--滑块验证start-->
                    <div id="trt_login_xx"></div>

                    <div class="form_tit1" id="app" style="position: fixed">

                    </div>

                    <!--滑块验证end-->



                </div>
                <div class="mar_t20" id="smsDiv" style="display:none">
                    <div class="form_tit"><span class="dl_icon2"></span><input name="" type="text" placeholder="请输入短信验证码"><a href="javascript:;" class="yzm">获取验证码</a></div>
                </div>
                <div class="form_tit3"><span><a href="#">立即注册</a>|<a href="#">忘记密码？</a></span><a href="javascript:;" onclick="changeLoginType(this);" id="changeText">手机动态码登录</a><div class="clear"></div></div>
                <input name="" type="submit" value="点击登录" class="dl_btn">
                <!--<div class="form_tit3"><span>没有帐号?<a href="#"> 免费注册</a></span><a href="#">找回密码</a><div class="clear"></div></div>-->
                <div class="form_tit5"><i class="line_l"></i><i class="line_r"></i>使用其他帐号登录</div>
                <div class="form_tit4"><a href="#"><img src="images/19ixm_dl_icon.png">福建政务服务网用户登录</a></div>
            </div>
        </div>
        <div class="ewm_con"><i class="zhdl_tu1"></i><em class="ewm_t2"></em>
            <div class="ewm_tit">手机扫码，安全登录</div>
            <div class="ewm_tu"><img src="images/19ixm_xl_tu.jpg">
                <p>请打开微信，扫一扫登录</p>
            </div>
        </div>
    </div>
</div>
<div class="dl_bot">主办：厦门市人民政府&nbsp;&nbsp;&nbsp;建设运营：厦门市民数据公司&nbsp;&nbsp;&nbsp;技术指导：厦门市信息中心&nbsp;&nbsp;&nbsp;闽ICP备14010412号-1&nbsp;&nbsp;&nbsp;网站标识码：3502000088</div>
<script src="images/19ixm_js.js" type="text/javascript"></script>
<script type="text/javascript">
	$('.zhdl_tu').click(function(){
		$('.ewm_con').slideDown();
		$('.zhdl_con').slideUp(0);
	})
	$('.zhdl_tu1').click(function(){
		$('.ewm_con').slideUp(0);
		$('.zhdl_con').slideDown();
	})
	var changeText = $("#changeText").text();
	if(changeText=="手机动态码登录"){
		$("input[name='loginType']").val("0");
	}else{
		$("input[name='loginType']").val("3");
	}
	function changeLoginType(obj){
		var loginType = $("input[name='loginType']").val();
		var targetObj = $(obj);
		if(loginType=="0"){
			$("#passDiv").attr("style","display:none;");
			$("#smsDiv").attr("style","");
			$("#passDiv1").attr("style","display:none;");
			$("#smsDiv1").attr("style","");
			targetObj.text("密码登录");
			$("input[name='loginType']").val("3");
	
		}else if(loginType=="3"){
			$("#passDiv").attr("style","");
			$("#smsDiv").attr("style","display:none;");
			$("#passDiv1").attr("style","");
			$("#smsDiv1").attr("style","display:none;");		
			targetObj.text("手机动态码登录");
			$("input[name='loginType']").val("0");
		}
	
}

	
	
	var currentImg=Math.floor(Math.random()*5);   //也就是让currentImg取得0-5之间的随机值，可以I等于,0和3，这个是用来取图片的索引下标的。
	var imgArr=['19ixm_dl_bg1.jpg','19ixm_dl_bg2.jpg','19ixm_dl_bg3.jpg','19ixm_dl_bg4.jpg','19ixm_dl_bg5.jpg'];//定义一个数组来存放所有的图片
	function changeImg(){
		var img=document.getElementById("page1");
		img.style.backgroundImage="url(images/"+imgArr[currentImg]+")"; //这里特别要注意引号的使用，因为imgArr[curentImg]是个变量，所以用"+变量+"
		
	}
	changeImg();
</script>

<script src="js/verify.js"></script>

<script>
    //错误信息5s后隐藏
    var time1;
    function showErrorMsg() {
        $("#trt_login_xx").css("display","block");
        clearTimeout(time1);
        time1=setTimeout(function () {
            $("#trt_login_xx").css("display","none");
        },5000);
    };
    //刷新验证码
    function refreshVerifyCode() {
        local.initSlideVerify();
        local.slideFail();
    }

    /**
     * 远程数据操作
     */
    var remoteDataOperation={
        /**
         * 滑动验证码验证结果
         * @param {Object} postData
         * @param {Object} callback
         */
        getSendTips : function(postData, callback, failCallback) {

            $.ajax({
                url: "/checkcode", //请求的url地址
                async: false,
                data: postData,//发送到服务器的参数
                dataType: "json", //服务器返回的值类型
                type: "POST", //请求方式
                success : function(row, d) {
                    callback && callback(row);
                },
                error : function(msg) {
                    failCallback && failCallback(msg);
                }
            });
        },

    }


    /**
     * 本地操作
     */
    var local ={

        /**
         * 隐藏验证成功
         */
        hideSlideSuccess: function() {
            $("#slideSuccess").addClass("hide");
        },

        /**
         * 验证成功样式
         */
        slideSuccess:function () {
            $("#slideSuccess").removeClass("hide");
            $(".verify-move-block").css('background-color', '#5cb85c');
            $('.verify-left-bar').css({'border-color': '#5cb85c', 'background-color': '#d2f4ef'});
            $('.verify-icon').css('color', '#fff').removeClass('icon-right icon-close').addClass('icon-check');
        },

        /**
         * 验证失败样式
         */
        slideFail:function () {
            $(".verify-move-block").css('background-color', '#d9534f');
            $('.verify-left-bar').css('border-color', '#d9534f');
            $('.verify-icon').css('color', '#fff').removeClass('icon-right icon-check').addClass('icon-close');
        },

        /**
         * 初始化滑动验证码
         */
        initSlideVerify : function() {
            // 滑动验证框宽度
            var slideWidth = $(".form_tit").width();
            //var slideHeight = $("#app").height();
            console.log(slideWidth);
            $('#app').empty();
            slideTrue = false;
            sendTicket="";
            //初始化滑块验证码
            $('#app').slideVerify({
                type: 2,     //类型
                mode : "pop", // 弹出式
                vOffset: 5,   //误差量，根据需求自行调整
                vSpace: 5,    //间隔
                imgName : "",
                smallImg : "",
                ticket:"",
                imgSize: {
                    width: slideWidth+"px",//'338px',
                    height: slideWidth/2+"px",//'169px',
                },
                blockSize: {
                    width: "42px",//'44px',
                    height: slideWidth/2+"px",//'169px',
                },
                barSize: {
                    width: slideWidth+"px",//'338px',
                    height: '42px',
                },
                ready: function () {
                },
                success: function (d, callback) {

                    //获取票据,拖动的值,图的宽度
                    /*var ticket = d.options.ticket;
                     var left = d.htmlDoms.left_bar[0].clientWidth;
                    var imageWidth=this.imgSize.width.substring(0,this.imgSize.width.length-2);
                    alert(ticket);
                    alert(left);
                    alert(imageWidth);*/

                    // 账号未填写不进行验证....

                    // 获取发送验证码票据
                    remoteDataOperation.getSendTips({
                        ticket : d.options.ticket,
                        dragPos : d.htmlDoms.left_bar[0].clientWidth,
                        imageWidth : this.imgSize.width.substring(0,this.imgSize.width.length-2)
                    }, function(ret) {
                        if(ret && ret.verifyPass && ret.accessToken) {

                            //slide.options.isShowImg = false;

                            // 验证成功
                            slideTrue = true;
                            sendTicket = ret.accessToken;
                            //$("#verifycode").val(sendTicket);
                            local.slideSuccess();

                            //隐藏错误提示信息
                            $("#trt_login_xx").css("display","none");

                            //解绑事件
                            $(".verify-move-block").unbind();
                        }else {
                            // 验证错误
                            slideTrue = false;
                            sendTicket = "";

                            local.hideSlideSuccess();
                            local.slideFail();

                            $("#trt_login_xx").text(ret.msg);
                            //$("#trt_login_xx").css("display","block");
                            //显示错误信息,5秒后隐藏
                            showErrorMsg();
                        }
                        callback && callback();

                    }, function(msg) {
                        //alert("验证失败");
                        // 验证错误
                        slideTrue = false;
                        sendTicket = "";
                        local.hideSlideSuccess();
                        local.slideFail();

                        $("#trt_login_xx").text("服务器繁忙,请稍后再试!");
                        //$("#trt_login_xx").css("display","block");
                        showErrorMsg();
                        callback && callback();
                    });




                },
                error: function () {
//               alert('验证失败！');
                    //解绑事件
                    $(".verify-move-block").unbind();
                }

            });



            //初始化方法
            _init();
            //初始化事件
            _initEvent();
        }
    }


    /**
     * 初始化事件
     */
    var _initEvent =function () {


        //滑块鼠标事件
        $(".verify-bar-area").mousemove(function () {
            //图显示
            $(".verify-sub-block").css("display","block");
            $(".verify-img-out").removeClass("ani-hide");

        });
        $(".verify-bar-area").mouseleave(function () {
            //图隐藏
            $(".verify-sub-block").css("display","none");
            $(".verify-img-out").addClass("ani-hide");

        });

        //大图
        $(".verify-img-out").mousemove(function () {
            //图显示
            $(".verify-sub-block").css("display","block");
            $(".verify-img-out").removeClass("ani-hide");
        });
        $(".verify-img-out").mouseleave(function () {
            //图隐藏
            $(".verify-sub-block").css("display","none");
            $(".verify-img-out").addClass("ani-hide");
        });

        //小图
        $(".verify-sub-block").mousemove(function () {
            //图显示
            $(".verify-sub-block").css("display","block");
            $(".verify-img-out").removeClass("ani-hide");
        });
        $(".verify-sub-block").mouseleave(function () {
            //图隐藏
            $(".verify-sub-block").css("display","none");
            $(".verify-img-out").addClass("ani-hide");
        });


    }

    /**
     * 初始化方法，可初始化数据、视图、事件，
     * 数据、视图、事件三者之间没有绝对的先后顺序，视具体情况而定
     */
    var _init=function () {
        //验证码隐藏
        $(".verify-sub-block").css("display","none");
        $(".verify-img-out").addClass("ani-hide");

        //弹出式
        $(".verify-img-out").css("position","absolute");
        $(".verify-img-out").css("left","1px");
        $(".verify-img-out").css("top","-"+($(".form_tit").width()/2+4)+"px");

        $(".verify-sub-block").css("position","absolute");
        $(".verify-sub-block").css("left","1px");
        $(".verify-sub-block").css("top","-"+($(".form_tit").width()/2+4)+"px");

    }


    $(function(){
        //初始化验证码
        local.initSlideVerify();
    });








</script>
</body>
</html>
